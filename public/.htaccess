#php_value session.auto_start 0
Options -Indexes
RewriteEngine On
#RewriteRule ^v-[0-9]\.[0-9]\.[0-9]/(.*)$ $1 [NC,L]

# current open task: remove the current opened task from URL (and place it in currentTaskId), so that resources (JS, CSS) are loaded properly
RewriteRule ^editor/taskid/([0-9]+)/(.*)$ $2?currentTaskId=$1 [NC,L,QSA]

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d 
RewriteRule ^.*$ - [NC,L]

#files tried to be loaded from reference HTML files are not piped through PHP
RewriteCond %{REQUEST_URI} editor/referencefile/
RewriteCond %{HTTP_REFERER} editor/referencefile/.*\.html$ 
RewriteRule ^.*$ - [NC,L]

# CORS Headers to be set on OPTIONS request only, other requests are handled by T5 itself
Header always add Access-Control-Max-Age "86400" env=preflight
Header always add Access-Control-Allow-Methods "GET,POST,PUT,DELETE,OPTIONS" env=preflight
Header always add Access-Control-Allow-Headers "Authorization,Content-Type,Accept,Origin,Translate5AuthToken" env=preflight
Header always add Access-Control-Allow-Origin "*" env=preflight
# Handling CORS OPTIONS Request
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [E=preflight:1,L,R=204]

# Add trailing slash on editor
RewriteRule ^((.*/)?editor)$ /$1/ [L,R]

RewriteRule ^.*$ index.php [NC,L]
